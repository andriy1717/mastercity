<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>City Master — Turn‑Based LAN Builder</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <header>
      <div class="hero">
        <div class="hero-text">
          <h1>City Master</h1>
          <p class="tagline">Build smart. Upgrade fast. Outplay your rivals in quick turns.</p>
          <nav class="hero-nav">
<<<<<<< HEAD
=======
            <div id="gameControls" class="game-controls" style="display: none;">
              <button id="musicToggle" class="iconBtn controlBtn" title="Toggle Music">
                <span class="controlIcon">🎵</span><span class="controlLabel">Music</span>
              </button>
              <button id="sfxToggle" class="iconBtn controlBtn" title="Toggle Sound Effects">
                <span class="controlIcon">🔔</span><span class="controlLabel">SFX</span>
              </button>
              <button id="restartBtn" class="iconBtn controlBtn" title="Restart Game (host only)">
                <span class="controlIcon">⟲</span><span class="controlLabel">Restart</span>
              </button>
              <button id="exitBtn" class="iconBtn controlBtn" title="Exit Session">
                <span class="controlIcon">🚪</span><span class="controlLabel">Exit</span>
              </button>
            </div>
>>>>>>> 0080bf9 (Initial commit)
            <a href="guide.html" class="guide-link">How to Play</a>
          </nav>
        </div>
        <div class="hero-art">
          <img src="/media/City%20Builders.png" alt="City Master" />
        </div>
      </div>
    </header>

    <section id="lobby">
      <div class="card lobby-card">
        <h2>Join or Create a Field</h2>
        <div class="row"><label>Ruler Name</label><input id="playerName" placeholder="e.g., Andriy" /></div>
        <div class="row"><label>Field Code</label><input id="roomCode" placeholder="e.g., ABC123" /></div>
        <div class="row">
          <label>Color</label>
          <select id="playerColor">
            <option value="blue" selected>Blue</option>
            <option value="red">Red</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
            <option value="purple">Purple</option>
            <option value="orange">Orange</option>
            <option value="teal">Teal</option>
            <option value="pink">Pink</option>
            <option value="cyan">Cyan</option>
            <option value="gray">Gray</option>
          </select>
        </div>
        <div class="row">
          <label>Civilization</label>
          <select id="playerCiv">
            <option value="Romans" selected>Romans</option>
            <option value="Vikings">Vikings</option>
            <option value="Mongols">Mongols</option>
            <option value="Slavs">Slavs</option>
          </select>
        </div>
        <div class="row buttons">
          <button id="createBtn">Create</button>
          <button id="joinBtn" class="secondary">Join</button>
<<<<<<< HEAD
		  
          <button id="playVsAiBtn" class="secondary">Play vs AI</button>
        </div>
=======
          <button id="playVsAiBtn" class="secondary">Play vs AI</button>
        </div>


>>>>>>> 0080bf9 (Initial commit)
        <p class="hint">
          Goal: gather resources, build and upgrade through the ages, and be the first to construct the Monument to win.
        </p>
      </div>
    </section>

    <section id="game" class="hidden">
      <div id="toast" class="toast"></div>

      <!-- Mobile End Turn Overlay (affixed) -->
      <div id="endTurnOverlay" class="hidden" style="position:fixed; top:0; left:0; right:0; display:none; pointer-events:auto; z-index:1100; background: rgba(2,6,23,0.55); box-shadow: 0 12px 28px rgba(0,0,0,0.35);">
        <div id="endTurnOverlayWrap" style="position:absolute; top:0; left:0; width:100%; padding:0; display:flex; justify-content:center;">
          <button id="endTurnOverlayBtn" class="endBtn" style="width:100%; max-width:640px; pointer-events:auto;">End Turn</button>
        </div>
      </div>

      <!-- Event Slider: Combined Logs & Chat -->
      <div id="eventSlider" class="event-slider collapsed">
        <div class="event-slider-header">
          <span class="event-slider-title">Chat</span>
        </div>
        <div class="event-slider-body">
          <div id="eventFeed" class="event-feed"></div>
          <div class="event-input-wrapper">
            <textarea id="eventChatInput" rows="1" placeholder="Type a message…"></textarea>
            <button id="eventChatSend" class="iconBtn" title="Send message">📤</button>
          </div>
        </div>
      </div>

      <div class="grid">
        <aside class="panel">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h3 style="font-size: 18px; margin: 0;">📊 Overview — <span id="roomName">—</span></h3>
<<<<<<< HEAD
            <div style="display: flex; gap: 4px;">
              <button id="musicToggle" class="iconBtn" title="Toggle Music" style="font-size: 14px; padding: 4px; background-color: #1e3a8a;">🎵</button>
              <button id="musicVolume" class="iconBtn" title="Cycle Music Volume" style="font-size: 14px; padding: 4px; background-color: #1e3a8a;">🔈</button>
              <button id="sfxToggle" class="iconBtn" title="Toggle Sound Effects" style="font-size: 14px; padding: 4px; background-color: #1e3a8a;">🔔</button>
              <button id="restartBtn" class="iconBtn" title="Restart Game (host only)" style="font-size: 14px; padding: 4px; background-color: #7c2d12;">⟲</button>
              <button id="exitBtn" class="iconBtn" title="Exit Session" style="font-size: 14px; padding: 4px; background-color: #991b1b;">🚪</button>
            </div>
=======
>>>>>>> 0080bf9 (Initial commit)
          </div>
          <div class="stats" id="meStats">
            <div id="seasonBenefits" class="seasonBenefits">
              <div style="font-weight: 700; margin-bottom: 4px;">
                <span id="dateLine">Year 1, Month 1 (Early Spring)</span>
              </div>
              <div style="font-weight: 700; margin-bottom: 6px;">
                <span id="seasonName">Spring</span> <span class="muted" id="seasonLeft"></span>
              </div>
            </div>
            <div id="statusBanner" class="banner muted"></div>
<<<<<<< HEAD
            <div class="actions two" id="lobbyActions">
              <button id="readyBtn" class="btn-dark">Ready</button>
            </div>
=======
          <div class="actions two" id="lobbyActions">
              <button id="readyBtn" class="btn-dark">Ready</button>
            </div>
            
            <!-- Add AI controls (visible after Play vs AI) -->
            <div id="addAiRow" class="row" style="display:none; margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.12);">
              <label style="font-weight: 700;">Add AI Opponent</label>
              <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; width: 100%;">
                <select id="aiColor">
                  <option value="gray" selected>Gray</option>
                  <option value="red">Red</option>
                  <option value="green">Green</option>
                  <option value="yellow">Yellow</option>
                  <option value="purple">Purple</option>
                  <option value="orange">Orange</option>
                  <option value="teal">Teal</option>
                  <option value="pink">Pink</option>
                  <option value="cyan">Cyan</option>
                  <option value="blue">Blue</option>
                </select>
                <select id="aiCiv">
                  <option value="Romans" selected>Romans</option>
                  <option value="Vikings">Vikings</option>
                  <option value="Mongols">Mongols</option>
                  <option value="Slavs">Slavs</option>
                </select>
                <button id="addAiBtn" class="secondary">Add AI</button>
              </div>
              <div class="muted" style="font-size: 12px; margin-top: 6px;">Add one or more AI before starting. Only host can add AIs.</div>
            </div>
>>>>>>> 0080bf9 (Initial commit)
            <div style="margin-top:6px; font-weight:800;">Players</div>
            <div id="playersMini" class="plist"></div>
          </div>
          <div class="actions two sidebarTurn">
            <button data-action="endTurn" class="endBtn">End Turn</button>
          </div>
        </aside>

        <main class="panel">
          <div class="columns">
            <section class="gatherSection" id="resourceSection">
              <h3 style="font-size: 18px; margin-bottom: 12px;">📦 Resource Management <span id="seasonDisplay" style="color: #facc15; font-weight: normal;"></span></h3>
              <div class="stats" style="margin-bottom:10px;" id="resourceStats">
                <div class="resline" data-res="wood">
                  <div class="resTile">
                    <div class="resIcon">🪵</div>
                    <div class="resText"><div class="resName">Wood</div><div class="resAmt"><span id="wood">0</span></div></div>
                    <button class="tileAction" data-action="gather-wood" title="Gather Wood"><span class="icon">🪓</span><span class="lbl">Gather wood</span><span class="yieldBadge" id="woodYield">+0</span></button>
                  </div>
                </div>
                <div class="resline" data-res="rock">
                  <div class="resTile">
                    <div class="resIcon">🪨</div>
                    <div class="resText"><div class="resName">Rock</div><div class="resAmt"><span id="rock">0</span></div></div>
                    <button class="tileAction" data-action="gather-rock" title="Mine Rock"><span class="icon">⛏️</span><span class="lbl">Mine rock</span><span class="yieldBadge" id="rockYield">+0</span></button>
                  </div>
                </div>
                <div class="resline" data-res="metal">
                  <div class="resTile">
                    <div class="resIcon">⚙️</div>
                    <div class="resText"><div class="resName">Metal</div><div class="resAmt"><span id="metal">0</span></div></div>
                    <button class="tileAction" data-action="gather-metal" title="Salvage Metal"><span class="icon">⚙️</span><span class="lbl">Salvage metal</span><span class="yieldBadge" id="metalYield">+0</span></button>
                  </div>
                </div>
                <div class="resline" data-res="food">
                  <div class="resTile">
                    <div class="resIcon">🍞</div>
                    <div class="resText"><div class="resName">Food</div><div class="resAmt"><span id="food">0</span></div></div>
                    <button class="tileAction" data-action="gather-food" title="Harvest Food"><span class="icon">🌾</span><span class="lbl">Harvest food</span><span class="yieldBadge" id="foodYield">+0</span></button>
                  </div>
                </div>
                <div class="resline" data-res="coins">
                  <div class="resTile coin">
                    <div class="resIcon">💰</div>
                    <div class="resText"><div class="resName">Golden Coins</div><div class="resAmt"><span id="coins">0</span></div></div>
                    <button class="tileAction" id="openTradeBtn" title="Trade"><span class="icon">🤝</span><span class="lbl">Trade</span><span class="yieldBadge" id="coinsYield">+0</span></button>
                  </div>
                </div>
              </div>
            </section>



            <section id="buildingSection">
              <h3 style="font-size: 18px; margin-bottom: 12px;">🏗️ Building Management — Age: <span id="buildAge">—</span> <button id="advanceAgeBtn" class="small" style="margin-left:8px; display:none;">Next Age</button></h3>
              <div id="buildGrid" class="build-grid"></div>

            </section>

            <section class="armySection" id="armySection">
              <h3 style="font-size: 18px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span aria-hidden="true">⚔️</span> Army Command — <span id="armyCiv">—</span>
              </h3>

              <div id="armyStats">
                <!-- Army Status Card -->
                <div style="background: linear-gradient(135deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.8) 100%); border: 2px solid rgba(220, 38, 38, 0.3); border-radius: 10px; padding: 12px; margin-bottom: 12px;">
                  <div class="muted" id="attackChanceLine" style="margin-bottom: 8px; font-size: 13px;"></div>

                  <!-- Soldiers with dynamic icon -->
                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <span id="soldierIcon" style="font-size: 24px;">🛡️</span>
                      <div>
                        <div style="font-weight: 700; color: #fbbf24;">Army Strength</div>
                        <div style="font-size: 13px; color: #94a3b8;" id="soldierLore">Your forces stand ready</div>
                      </div>
                    </div>
                      <div style="text-align: right;">
<<<<<<< HEAD
                        <div style="font-size: 20px; font-weight: 900; color: #e2e8f0;"><span id="armySoldiers">0</span>/<span id="armyCap">0</span></div>
=======
                        <div style="font-size: 16px; font-weight: 700; color: #cbd5e1;"><span id="armySoldiers">0</span>/<span id="armyCap">0</span></div>
>>>>>>> 0080bf9 (Initial commit)
                      </div>
                  </div>

                  <!-- Defence with lore -->
                  <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 8px; border-top: 1px solid rgba(148, 163, 184, 0.2);">
                    <div>
                      <div style="font-weight: 700; color: #10b981;">Fortifications</div>
                      <div style="font-size: 13px; color: #94a3b8;" id="defenseLore">Walls and towers stand guard</div>
                    </div>
                    <div style="font-size: 18px; font-weight: 900; color: #10b981;" id="armyDefense">0%</div>
                  </div>

                  <!-- Raid Status -->
                  <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(148, 163, 184, 0.2);">
                    <div style="font-size: 12px; color: #94a3b8;" id="armyRaidStatus">No raid in progress.</div>
                  </div>
                </div>

                <!-- Training Section -->
                <div style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(217, 119, 6, 0.05) 100%); border: 2px solid rgba(251, 191, 36, 0.2); border-radius: 10px; padding: 10px; margin-bottom: 10px;">
                  <div style="font-size: 13px; font-weight: 700; color: #fbbf24; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                    <span>🏋️</span> Training Grounds
                  </div>
                  <button data-action="train" id="trainBtn" style="width: 100%; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border: none; color: #78350f; font-weight: 800;">Recruit Soldiers</button>
                  <div class="muted" id="armyHint" style="margin-top: 6px; font-size: 12px;"></div>
                </div>

                <!-- Offensive Operations -->
                <div style="background: linear-gradient(135deg, rgba(220, 38, 38, 0.15) 0%, rgba(153, 27, 27, 0.05) 100%); border: 2px solid rgba(220, 38, 38, 0.3); border-radius: 10px; padding: 10px; margin-bottom: 10px;">
                  <div style="font-size: 13px; font-weight: 700; color: #ef4444; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                    <span>⚔️</span> Offensive Operations
                  </div>
                  <button data-action="raid" id="raidBtn" style="width: 100%; background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); border: none; color: #fff; font-weight: 800; margin-bottom: 6px;">Go To War</button>
                  <div id="warRiskLine" class="muted" style="font-size: 12px; margin-bottom: 6px;"></div>
                  <button id="triggerRaidBtn" style="width: 100%; background: linear-gradient(135deg, #7c2d12 0%, #451a03 100%); border: none; color: #fdba74; font-weight: 700; font-size: 14px;">💰 Hire Mercenaries (20 coins)</button>
                </div>

                <!-- Diplomatic Actions -->
                <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(109, 40, 217, 0.05) 100%); border: 2px solid rgba(139, 92, 246, 0.2); border-radius: 10px; padding: 10px; margin-bottom: 10px;">
                  <div style="font-size: 13px; font-weight: 700; color: #a78bfa; margin-bottom: 6px; display: flex; align-items: center; gap: 6px;">
                    <span>🐪</span> Diplomacy
                  </div>
                  <button id="openVisitBtn" style="width: 100%; background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); border: none; color: #fff; font-weight: 700;">Send a Visitor</button>
                </div>

                <div id="visitInbox" class="visitInbox"></div>
              </div>
            </section>
          </div>
          </main>
        
      </div>
    </section>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="client.js"></script>
  <script src="trade-modal-controller.js"></script>

  <!-- Visitor Modal -->
  <div id="visitModal" class="modal hidden">
    <div class="modal-content dark-theme" style="max-width: 600px;">
      <div class="modal-header"><span>Send a Visitor (Once Per Season)</span><button id="visitClose" class="iconBtn">✖</button></div>
      <div class="modal-body">
        <div class="section">
          <div class="row"><label>Send To</label><select id="visitTarget2"></select></div>

          <div style="margin: 20px 0;">
            <label style="margin-bottom: 12px; display: block; font-weight: bold;">Choose Visitor Type:</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">

              <!-- Trader Option -->
              <div class="visitor-option-card" data-kind="trader" style="cursor: pointer; padding: 14px; border: 2px solid #4ade80; background: rgba(74, 222, 128, 0.1); border-radius: 8px; transition: all 0.2s;">
                <div style="text-align: center; font-size: 40px; margin-bottom: 6px;">🤝</div>
                <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 6px; color: #4ade80;">Trader</div>
                <div style="font-size: 11px; line-height: 1.4; color: #cbd5e1;">
                  <strong>Accept:</strong> Both get +20 coins<br>
                  <strong>Reject:</strong> You get +20 coins
                </div>
              </div>

              <!-- Spy Option -->
              <div class="visitor-option-card" data-kind="spy" style="cursor: pointer; padding: 14px; border: 2px solid #8b5cf6; background: rgba(139, 92, 246, 0.1); border-radius: 8px; transition: all 0.2s;">
                <div style="text-align: center; font-size: 40px; margin-bottom: 6px;">🕵️</div>
                <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 6px; color: #8b5cf6;">Spy</div>
                <div style="font-size: 11px; line-height: 1.4; color: #cbd5e1;">
                  <strong>Accept:</strong> Get intel (defense + 2 resources)<br>
                  <strong>Reject:</strong> No intel gained
                </div>
              </div>

              <!-- Robber Option -->
              <div class="visitor-option-card" data-kind="robber" style="cursor: pointer; padding: 14px; border: 2px solid #ef4444; background: rgba(239, 68, 68, 0.1); border-radius: 8px; transition: all 0.2s;">
                <div style="text-align: center; font-size: 40px; margin-bottom: 6px;">🎭</div>
                <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 6px; color: #ef4444;">Robber</div>
                <div style="font-size: 11px; line-height: 1.4; color: #cbd5e1;">
                  <strong>Accept:</strong> Steal 10 coins, you get +30 total<br>
                  <strong>Reject:</strong> No coins stolen
                </div>
              </div>

            </div>
          </div>

          <div class="muted" style="margin:12px 0; text-align: center;">Cost: 1 Move + 10 Golden Coins</div>
          <div class="row buttons">
            <button id="visitSendBtn" class="btn-dark">Send Selected Visitor</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Visitor Outcome Modal -->
  <div id="visitorOutcomeModal" class="modal hidden" style="z-index: 1300;">
    <div class="modal-content dark-theme" style="max-width: 600px; max-height: 90vh; overflow-y: auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 3px solid #fbbf24;">
      <div class="modal-body" style="padding: 0;">
        <!-- Trader Image -->
        <div style="position: relative; width: 100%; height: 200px; overflow: hidden; background: #000;">
          <img id="visitorOutcomeImage" src="/media/trader.png" alt="Visitor" style="width: 100%; height: 100%; object-fit: contain;">
          <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(15,23,42,0.9));"></div>
        </div>

        <!-- Outcome Info -->
        <div style="padding: 20px;">
          <div id="visitorOutcomeText" style="font-size: 15px; line-height: 1.6; color: #cbd5e1; white-space: pre-line; margin-bottom: 20px;"></div>

          <!-- Close Button -->
          <div style="text-align: center;">
            <button id="visitorOutcomeClose" style="padding: 10px 32px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #78350f; border: none; border-radius: 8px; cursor: pointer;">
              Continue
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- NEW TRADE MODAL -->
  <div id="tradeModal" class="modal hidden">
    <div class="modal-content dark-theme" style="max-width: 500px;">
      <div class="modal-header">
        <span id="tradeTitle">Trade</span>
        <button id="tradeClose" class="iconBtn">✖</button>
      </div>
      <div class="modal-body" id="tradeBody" style="padding: 20px;">

        <!-- Step 1: Choose Action (BUY/SELL/TRADE) -->
        <div id="tradeStep1" class="trade-step">
          <h3 style="text-align: center; margin-bottom: 20px; font-size: 20px;">Choose Action</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
            <button class="trade-action-btn" data-action="buy">
              <div style="font-size: 28px;">🏦</div>
              <div style="font-weight: bold; margin-top: 8px;">BUY</div>
              <div style="font-size: 11px; opacity: 0.7;">From Bank</div>
            </button>
            <button class="trade-action-btn" data-action="sell">
              <div style="font-size: 28px;">💰</div>
              <div style="font-weight: bold; margin-top: 8px;">SELL</div>
              <div style="font-size: 11px; opacity: 0.7;">To Bank</div>
            </button>
            <button class="trade-action-btn" data-action="trade">
              <div style="font-size: 28px;">🤝</div>
              <div style="font-weight: bold; margin-top: 8px;">TRADE</div>
              <div style="font-size: 11px; opacity: 0.7;">With Player</div>
            </button>
          </div>
        </div>

        <!-- Step 2: Select Resource (for BUY/SELL) -->
        <div id="tradeStep2" class="trade-step hidden">
          <h3 id="step2Title" style="text-align: center; margin-bottom: 20px; font-size: 20px;">Select Resource</h3>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
            <button class="resource-btn" data-resource="wood">
              <div style="font-size: 24px;">🪵</div>
              <div style="font-weight: bold; margin-top: 6px;">Wood</div>
            </button>
            <button class="resource-btn" data-resource="rock">
              <div style="font-size: 24px;">🪨</div>
              <div style="font-weight: bold; margin-top: 6px;">Rock</div>
            </button>
            <button class="resource-btn" data-resource="metal">
              <div style="font-size: 24px;">⚙️</div>
              <div style="font-weight: bold; margin-top: 6px;">Metal</div>
            </button>
            <button class="resource-btn" data-resource="food">
              <div style="font-size: 24px;">🍞</div>
              <div style="font-weight: bold; margin-top: 6px;">Food</div>
            </button>
          </div>
          <button id="backToStep1" class="btn-back" style="margin-top: 15px; width: 100%;">← Back</button>
        </div>

        <!-- Step 3: Select Quantity (for BUY/SELL) -->
        <div id="tradeStep3" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 15px; font-size: 20px;">How much?</h3>
          <div style="text-align: center; margin-bottom: 20px;">
            <div id="selectedResourceIcon" style="font-size: 28px; margin-bottom: 10px;">🪵</div>
            <div id="selectedResourceName" style="font-weight: bold; font-size: 18px;">Wood</div>
          </div>
          <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px;">
            <button id="decreaseQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">−</button>
            <div id="quantityDisplay" style="font-size: 36px; font-weight: bold; min-width: 80px; text-align: center;">1</div>
            <button id="increaseQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">+</button>
          </div>
          <div id="costDisplay" style="text-align: center; font-size: 16px; margin-bottom: 20px; min-height: 24px; font-weight: bold;"></div>
          <div style="display: flex; gap: 10px;">
            <button id="backToStep2" class="btn-back" style="flex: 1; padding: 12px; border-radius: 6px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">← Back</button>
            <button id="confirmTrade" class="btn-primary" style="flex: 2; padding: 12px; border-radius: 6px; background: #d4a82e; color: #1a1a1a; font-weight: bold; border: none; cursor: pointer;">Send Offer</button>
          </div>
        </div>

        <!-- Step 4: Select Player (for TRADE) -->
        <div id="tradeStep4" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 20px; font-size: 20px;">Trade With</h3>
          <div id="playerGrid" style="display: grid; gap: 10px;"></div>
          <button id="backToStep1FromPlayer" class="btn-back" style="margin-top: 15px; width: 100%; padding: 12px; border-radius: 6px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">← Back</button>
        </div>

        <!-- Step 5: What to Give (for TRADE) -->
        <div id="tradeStep5" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 15px; font-size: 20px;">What do you want to trade?</h3>
          <div style="text-align: center; margin-bottom: 15px; font-size: 14px; opacity: 0.8;">
            Trading with: <strong id="selectedPlayerName"></strong>
          </div>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
            <button class="resource-btn give-resource" data-resource="wood">
              <div style="font-size: 24px;">🪵</div>
              <div style="font-weight: bold; margin-top: 6px;">Wood</div>
            </button>
            <button class="resource-btn give-resource" data-resource="rock">
              <div style="font-size: 24px;">🪨</div>
              <div style="font-weight: bold; margin-top: 6px;">Rock</div>
            </button>
            <button class="resource-btn give-resource" data-resource="metal">
              <div style="font-size: 24px;">⚙️</div>
              <div style="font-weight: bold; margin-top: 6px;">Metal</div>
            </button>
            <button class="resource-btn give-resource" data-resource="food">
              <div style="font-size: 24px;">🍞</div>
              <div style="font-weight: bold; margin-top: 6px;">Food</div>
            </button>
            <button class="resource-btn give-resource" data-resource="coins" style="grid-column: span 2;">
              <div style="font-size: 24px;">💰</div>
              <div style="font-weight: bold; margin-top: 6px;">Golden Coins</div>
            </button>
          </div>
          <button id="backToStep4" class="btn-back" style="margin-top: 15px; width: 100%; padding: 12px; border-radius: 6px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">← Back</button>
        </div>

        <!-- Step 6: How Much to Give (for TRADE) -->
        <div id="tradeStep6" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 15px; font-size: 20px;">How much to trade?</h3>
          <div style="text-align: center; margin-bottom: 20px;">
            <div id="giveResourceIcon" style="font-size: 28px; margin-bottom: 10px;">🪵</div>
            <div id="giveResourceName" style="font-weight: bold; font-size: 18px;">Wood</div>
          </div>
          <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px;">
            <button id="decreaseGiveQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">−</button>
            <div id="giveQuantityDisplay" style="font-size: 36px; font-weight: bold; min-width: 80px; text-align: center;">1</div>
            <button id="increaseGiveQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">+</button>
          </div>
          <button id="continueToWant" class="btn-primary" style="width: 100%; padding: 12px; border-radius: 6px; background: #d4a82e; color: #1a1a1a; font-weight: bold; border: none; cursor: pointer;">Next →</button>
        </div>

        <!-- Step 7: What to Get (for TRADE) -->
        <div id="tradeStep7" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 15px; font-size: 20px;">What do you want to get?</h3>
          <div style="text-align: center; margin-bottom: 15px; font-size: 13px; opacity: 0.8;">
            You're offering: <strong><span id="offerSummary"></span></strong>
          </div>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
            <button class="resource-btn want-resource" data-resource="wood">
              <div style="font-size: 24px;">🪵</div>
              <div style="font-weight: bold; margin-top: 6px;">Wood</div>
            </button>
            <button class="resource-btn want-resource" data-resource="rock">
              <div style="font-size: 24px;">🪨</div>
              <div style="font-weight: bold; margin-top: 6px;">Rock</div>
            </button>
            <button class="resource-btn want-resource" data-resource="metal">
              <div style="font-size: 24px;">⚙️</div>
              <div style="font-weight: bold; margin-top: 6px;">Metal</div>
            </button>
            <button class="resource-btn want-resource" data-resource="food">
              <div style="font-size: 24px;">🍞</div>
              <div style="font-weight: bold; margin-top: 6px;">Food</div>
            </button>
            <button class="resource-btn want-resource" data-resource="coins" style="grid-column: span 2;">
              <div style="font-size: 24px;">💰</div>
              <div style="font-weight: bold; margin-top: 6px;">Golden Coins</div>
            </button>
          </div>
          <button id="backToStep6" class="btn-back" style="margin-top: 15px; width: 100%; padding: 12px; border-radius: 6px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">← Back</button>
        </div>

        <!-- Step 8: How Much to Get (for TRADE) -->
        <div id="tradeStep8" class="trade-step hidden">
          <h3 style="text-align: center; margin-bottom: 15px; font-size: 20px;">How much to trade for?</h3>
          <div style="text-align: center; margin-bottom: 20px;">
            <div id="wantResourceIcon" style="font-size: 28px; margin-bottom: 10px;">🪵</div>
            <div id="wantResourceName" style="font-weight: bold; font-size: 18px;">Wood</div>
          </div>
          <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px;">
            <button id="decreaseWantQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">−</button>
            <div id="wantQuantityDisplay" style="font-size: 36px; font-weight: bold; min-width: 80px; text-align: center;">1</div>
            <button id="increaseWantQty" class="qty-btn" style="font-size: 32px; width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">+</button>
          </div>
          <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
            <div style="font-size: 14px; opacity: 0.8; margin-bottom: 5px;">Trade Summary:</div>
            <div style="font-size: 15px;"><strong id="finalTradeSummary"></strong></div>
          </div>
          <div style="display: flex; gap: 10px;">
            <button id="backToStep7" class="btn-back" style="flex: 1; padding: 12px; border-radius: 6px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); cursor: pointer;">← Back</button>
            <button id="sendPlayerOffer" class="btn-primary" style="flex: 2; padding: 12px; border-radius: 6px; background: #d4a82e; color: #1a1a1a; font-weight: bold; border: none; cursor: pointer;">Send Offer</button>
          </div>
        </div>

        <!-- Result Screen -->
        <div id="tradeResult" class="trade-step hidden">
          <div style="text-align: center; padding: 20px;">
            <div id="resultIcon" style="font-size: 64px; margin-bottom: 15px;">✅</div>
            <h3 id="resultTitle" style="margin-bottom: 10px;">Success!</h3>
            <div id="resultMessage" style="font-size: 15px; opacity: 0.9; margin-bottom: 25px; line-height: 1.6;"></div>
            <button id="closeTradeModal" class="btn-primary" style="width: 100%; padding: 12px; border-radius: 6px; background: #d4a82e; color: #1a1a1a; font-weight: bold; border: none; cursor: pointer;">Close</button>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Incoming Offer Modal -->
  <div id="offerModal" class="modal hidden">
    <div class="modal-content dark-theme">
      <div class="modal-header"><span>Trade Offer</span><button id="offerClose" class="iconBtn">✖</button></div>
      <div class="modal-body">
        <div id="offerText">—</div>
        <div class="row buttons" style="margin-top:8px;">
          <button id="offerAccept">Accept</button>
          <button id="offerDecline" class="secondary">Decline</button>
        </div>
        <div class="section" style="margin-top:10px;">
          <h4>Counter Offer</h4>
          <div class="row"><label>You Give</label>
            <select id="counterGiveType">
              <option value="wood">Wood</option>
              <option value="rock">Rock</option>
              <option value="metal">Metal</option>
              <option value="food">Food</option>
              <option value="coins">Coins</option>
            </select>
            <input id="counterGiveAmt" type="number" min="1" value="5" />
          </div>
          <div class="row"><label>You Get</label>
            <select id="counterWantType">
              <option value="wood">Wood</option>
              <option value="rock">Rock</option>
              <option value="metal">Metal</option>
              <option value="food">Food</option>
              <option value="coins">Coins</option>
            </select>
            <input id="counterWantAmt" type="number" min="1" value="5" />
          </div>
          <div class="row buttons">
            <button id="sendCounter">Send Counter</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lobby Waiting/Lore Modal -->
  <div id="lobbyModal" class="modal hidden">
    <div class="modal-content dark-theme">
      <div class="modal-header">
        <span id="lobbyModalTitle">Preparing for Battle</span>
      </div>
      <div class="modal-body">
        <div id="lobbyModalText" class="section" style="min-height: 120px; text-align: center; padding: 20px;">
          <p style="font-size: 1.1em;">Waiting for other players...</p>
        </div>
        <div id="lobbyReadySection" class="hidden" style="text-align: center; padding: 10px 0;">
          <button id="lobbyReadyBtn" class="btn-dark" style="font-size: 1.1em; padding: 12px 32px;">Ready</button>
          <div id="lobbyReadyStatus" style="margin-top: 10px;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Story Intro Modal -->
  <div id="storyModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><span>Prologue</span><button id="storyClose" class="iconBtn">✖</button></div>
      <div class="modal-body">
        <div id="storyText" class="section"></div>
      </div>
    </div>
  </div>

  <!-- Chat Message Modal -->
  <div id="chatMessageModal" class="modal hidden">
    <div class="modal-content dark-theme">
      <div class="modal-header"><span>💬 New Chat Message</span><button id="chatMessageClose" class="iconBtn">✖</button></div>
      <div class="modal-body">
        <div class="section" style="padding: 16px;">
          <div style="margin-bottom: 12px;">
            <strong id="chatMessagePlayer" style="font-size: 1.1em;"></strong>
          </div>
          <div id="chatMessageText" style="font-size: 1em; line-height: 1.6;"></div>
          <div id="chatMessageImageWrap" class="chat-message-image hidden">
            <img id="chatMessageImage" src="" alt="Dispatch illustration">
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Visitor Decision Modal (Blocking) -->
  <div id="visitorDecisionModal" class="modal hidden">
    <div class="modal-content dark-theme">
      <div class="modal-header"><span>🚪 Visitor at the Gate</span></div>
      <div class="modal-body">
        <div style="padding: 16px;">
          <div style="margin-bottom: 12px;">
            <strong style="font-size: 1.1em; color: #facc15;">From: <span id="visitorFrom"></span></strong>
          </div>
          <div id="visitorLore" style="font-size: 1em; line-height: 1.6; margin-bottom: 20px; padding: 12px; background: rgba(250,204,21,0.1); border-left: 3px solid #facc15; border-radius: 4px;"></div>
          <div style="margin-bottom: 16px; font-style: italic; color: #cbd5e1;">
            Will you let this visitor enter your gates?
          </div>
          <div class="row buttons" style="margin-top:8px;">
            <button id="visitorAcceptBtn">Accept</button>
            <button id="visitorRejectBtn" class="secondary">Reject</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Raid Notification Modal -->
  <div id="raidNotificationModal" class="modal hidden" style="background: rgba(0, 0, 0, 0.95); backdrop-filter: blur(10px); z-index: 1300;">
    <div class="modal-content dark-theme" style="max-width: 700px; max-height: 90vh; overflow-y: auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 3px solid #ef4444;">
      <div class="modal-body" style="padding: 0;">
        <!-- Raid Image -->
        <div style="position: relative; width: 100%; height: 280px; overflow: hidden; background: #000;">
          <img id="raidImage" src="" alt="Raid" style="width: 100%; height: 100%; object-fit: contain;">
          <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(15,23,42,0.9));"></div>
        </div>

        <!-- Raid Info -->
        <div style="padding: 20px; margin-top: -80px; position: relative; z-index: 10;">
          <!-- Outcome Badge -->
          <div id="raidOutcomeBadge" style="text-align: center; margin-bottom: 12px;">
            <div style="display: inline-block; padding: 8px 28px; border-radius: 50px; font-size: 22px; font-weight: 900; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
              <span id="raidOutcomeText"></span>
            </div>
          </div>

          <!-- Target Player -->
          <div style="text-align: center; margin-bottom: 14px;">
            <div style="font-size: 18px; font-weight: 700; color: #fbbf24;">
              <span id="raidTargetPlayer"></span>
            </div>
          </div>

          <!-- Raid Details -->
          <div id="raidDetails" style="background: rgba(30, 41, 59, 0.6); padding: 14px; border-radius: 10px; border-left: 4px solid #ef4444; margin-bottom: 16px;">
            <div id="raidDetailsText" style="font-size: 14px; line-height: 1.5; color: #cbd5e1;"></div>
          </div>

          <!-- Close Button -->
          <div style="text-align: center;">
            <button id="raidNotificationClose" style="padding: 10px 32px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: #fff; border: none; border-radius: 8px; cursor: pointer;">
              Continue
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmModal" class="modal hidden" style="z-index: 1400;">
    <div class="modal-content dark-theme" style="max-width: 500px; max-height: 90vh; overflow-y: auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 3px solid #fbbf24;">
      <div class="modal-header" style="background: linear-gradient(180deg, rgba(250,204,21,0.12), rgba(250,204,21,0.06)); color: #fbbf24; border-bottom: 1px solid rgba(250,204,21,0.2);">
        <span id="confirmTitle">Confirm Action</span>
      </div>
      <div class="modal-body" style="padding: 20px;">
        <div id="confirmMessage" style="font-size: 15px; line-height: 1.6; color: #cbd5e1; text-align: center; margin-bottom: 20px;"></div>
        <div style="display: flex; gap: 10px; justify-content: center;">
          <button id="confirmYes" style="flex: 1; padding: 12px 24px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #78350f; border: none; border-radius: 8px; cursor: pointer;">Confirm</button>
          <button id="confirmNo" style="flex: 1; padding: 12px 24px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #475569 0%, #334155 100%); color: #e2e8f0; border: none; border-radius: 8px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mercenary Hire Modal -->
  <div id="mercenaryModal" class="modal hidden" style="z-index: 1400;">
    <div class="modal-content dark-theme" style="max-width: 550px; max-height: 90vh; overflow-y: auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 3px solid #fdba74;">
      <div class="modal-header" style="background: linear-gradient(180deg, rgba(253, 186, 116, 0.15), rgba(124, 45, 18, 0.1)); color: #fdba74; border-bottom: 1px solid rgba(253, 186, 116, 0.3);">
        <span>💰 Hire Mercenaries</span>
        <button id="mercenaryClose" class="iconBtn" style="color: #fdba74;">✖</button>
      </div>
      <div class="modal-body" style="padding: 20px;">
        <div style="background: rgba(124, 45, 18, 0.2); border: 1px solid rgba(253, 186, 116, 0.3); border-radius: 8px; padding: 14px; margin-bottom: 16px;">
          <div style="font-size: 14px; line-height: 1.6; color: #cbd5e1; text-align: center;">
            Hire mercenaries to raid a target of your choice at the end of this season. The raid is guaranteed to succeed.
          </div>
          <div style="font-size: 13px; color: #94a3b8; text-align: center; margin-top: 8px;">
            Cost: <span style="color: #fbbf24; font-weight: 700;">20 Golden Coins</span>
          </div>
          <div style="font-size: 13px; color: #94a3b8; text-align: center; margin-top: 4px;">
            Mercenaries take 30% of the spoils as their fee.
          </div>
        </div>

        <div style="margin-bottom: 16px;">
          <label style="display: block; font-weight: 700; color: #fbbf24; margin-bottom: 8px;">Select Target:</label>
          <select id="mercenaryTarget" style="width: 100%; padding: 10px; font-size: 15px; background: rgba(15, 23, 42, 0.8); color: #e2e8f0; border: 2px solid rgba(253, 186, 116, 0.3); border-radius: 8px; font-weight: 600;">
            <option value="">-- Choose a player to raid --</option>
          </select>
        </div>

        <div style="display: flex; gap: 10px; justify-content: center;">
          <button id="mercenaryConfirm" style="flex: 1; padding: 12px 24px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #fdba74 0%, #fb923c 100%); color: #78350f; border: none; border-radius: 8px; cursor: pointer;">Hire Mercenaries</button>
          <button id="mercenaryCancel" style="flex: 1; padding: 12px 24px; font-size: 16px; font-weight: 700; background: linear-gradient(135deg, #475569 0%, #334155 100%); color: #e2e8f0; border: none; border-radius: 8px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
  </div>

<<<<<<< HEAD
=======
  <!-- Play vs AI Setup Modal -->
  <div id="aiSetupModal" class="modal hidden">
    <div class="modal-content dark-theme" style="max-width: 600px;">
      <div class="modal-header"><span>Play vs AI — Setup Opponents</span><button id="aiCancelBtn" class="iconBtn">✖</button></div>
      <div class="modal-body" style="padding: 20px;">
        <div class="row"><label>Color</label>
          <select id="aiColor">
            <option value="gray" selected>Gray</option>
            <option value="red">Red</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
            <option value="purple">Purple</option>
            <option value="orange">Orange</option>
            <option value="teal">Teal</option>
            <option value="pink">Pink</option>
            <option value="cyan">Cyan</option>
            <option value="blue">Blue</option>
          </select>
        </div>
        <div class="row"><label>Civilization</label>
          <select id="aiCiv">
            <option value="Romans" selected>Romans</option>
            <option value="Vikings">Vikings</option>
            <option value="Mongols">Mongols</option>
            <option value="Slavs">Slavs</option>
          </select>
        </div>
        <div class="row buttons" style="margin-top:8px;">
          <button id="aiAddBtn">Add AI</button>
        </div>
        <div class="section" style="margin-top:10px;">
          <h4>Added AIs</h4>
          <div id="aiList"></div>
        </div>
        <div class="row buttons" style="margin-top:12px;">
          <button id="aiStartBtn" class="btn-dark">Start Game</button>
        </div>
      </div>
    </div>
  </div>

>>>>>>> 0080bf9 (Initial commit)
  <!-- Victory Screen Modal (Mobile-first, narrative summary) -->
  <div id="victoryModal" class="modal hidden" style="background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(8px);">
    <div class="modal-content dark-theme" style="max-width: 900px; max-height: 92vh; overflow-y: auto; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 3px solid #fbbf24;">
      <!-- Compact Winner Header -->
      <div style="display:flex; align-items:center; gap:12px; padding:14px 16px; background: linear-gradient(180deg, rgba(250,204,21,0.12), rgba(250,204,21,0.06)); border-bottom:1px solid rgba(250,204,21,0.25); position: sticky; top:0; z-index:2;">
        <div style="font-size:28px; line-height:1;">🏆</div>
        <div style="display:flex; flex-direction:column;">
          <div style="font-size:18px; font-weight:900; color:#facc15; letter-spacing:0.02em;">Winner</div>
          <div style="font-size:20px; font-weight:900; color:#e2e8f0;">
            <span id="victoryWinnerName">—</span>
            <span style="opacity:0.7; font-weight:700;">—</span>
            <span id="victoryWinnerCiv" style="opacity:0.8; font-weight:700;">—</span>
          </div>
          <div id="victorySubtitle" style="font-size:13px; color:#cbd5e1; opacity:0.9; margin-top:2px;"></div>
        </div>
      </div>

      <div style="padding:14px 16px; display:flex; flex-direction:column; gap:14px;">
        <!-- Quick Facts -->
        <div id="victoryFacts" style="display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:10px;">
          <!-- facts injected here -->
        </div>

        <!-- Narrative Summary -->
        <div style="background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(250,204,21,0.2); border-radius: 10px; padding: 12px;">
          <div style="font-weight:900; color:#facc15; margin-bottom:6px;">Epic Chronicle</div>
          <div id="victoryNarrative" style="font-size:14px; line-height:1.6; color:#cbd5e1;"></div>
        </div>

        <!-- Per-Player Cards -->
        <div style="background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(250,204,21,0.2); border-radius: 10px; padding: 12px;">
          <div style="font-weight:900; color:#facc15; margin-bottom:6px;">Final Standings</div>
          <div id="playerStatsContainer"></div>
        </div>

        <!-- Actions -->
        <div style="text-align:center; padding-top:4px;">
          <button onclick="location.reload()" style="padding: 12px 22px; font-size: 15px; font-weight: 800; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #78350f; border: none; border-radius: 8px; cursor: pointer; box-shadow: 0 4px 12px rgba(251, 191, 36, 0.35);">Return to Lobby</button>
        </div>
      </div>
    </div>
  </div>

  <style>
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }

    .stat-card {
      background: rgba(30, 41, 59, 0.8);
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      border: 2px solid rgba(251, 191, 36, 0.3);
    }

    .stat-label {
      font-size: 14px;
      color: #94a3b8;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .stat-value {
      font-size: 28px;
      font-weight: 700;
      color: #fbbf24;
    }

    .player-stat-row {
      background: rgba(30, 41, 59, 0.6);
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 15px;
      border-left: 4px solid;
    }

    .player-stat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }

    .player-stat-name {
      font-size: 24px;
      font-weight: 700;
    }

    .player-stat-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .player-stat-item {
      text-align: center;
      padding: 10px;
      background: rgba(15, 23, 42, 0.6);
      border-radius: 6px;
    }

    .player-stat-item-label {
      font-size: 12px;
      color: #94a3b8;
      margin-bottom: 5px;
    }

    .player-stat-item-value {
      font-size: 20px;
      font-weight: 700;
      color: #fbbf24;
    }

  </style>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Convert any leftover "AP" labels in buttons to "Moves"
  document.querySelectorAll('button, .sub, .stats, .actions').forEach(el=>{
    el.innerHTML = el.innerHTML.replaceAll('(1 AP)','(1 Move)').replaceAll(' AP',' Moves');
  });
});
</script>

</body>
</html>
